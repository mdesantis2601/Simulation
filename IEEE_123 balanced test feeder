function mpc = IEEE_123_Case_PL_base

%% MATPOWER Case Format : Version 2
mpc.version = '2';

%%-----  Power Flow Data  -----%%
%% system MVA base
mpc.baseMVA = 1;

%% bus data
%	bus_i	type	Pd	Qd	Gs	Bs	area	Vm	Va	baseKV	zone	Vmax	Vmin
mpc.bus = [
	1	3	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	3	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	4	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	400	1	0	0	0	0	1	1	0	4.16	1	1.05	0.95;
	7	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	11	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	1100	1	0	0	0	0	1	1	0	4.16	1	1.05	0.95;
	14	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	1400	1	0	0	0	0	1	1	0	4.16	1	1.1	0.9;
	126	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	59	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	60	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	61	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	63	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	66	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	6600	1	0	0	0	0	1	1	0	4.16	1	1.1	0.9;
	128	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	127	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	74	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	7400	1	0	0	0	0	1	1	0	4.16	1	1.1	0.9;
	77	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	109	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	110	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	112	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	116	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	118	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	120	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	122	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	123	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	124	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	6	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	9	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	10	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	8	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	5	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	13	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	15	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	16	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	20	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	19	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	12	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	18	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	1800	1	0	0	0	0	1	1	0	4.16	1	1.1	0.9;
	25	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	28	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	30	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	33	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	37	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	38	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	39	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	125	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	41	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	43	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	48	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	50	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	52	1	0	0	0.105	-0.075	1	1	0	4.16	1	1.05	0.95;
	55	1	0	0	0.14	-0.095	1	1	0	4.16	1	1.05	0.95;
	56	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	57	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	58	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	42	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	45	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	46	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	44	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	47	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	49	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	51	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	53	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	54	1	0	0	0.21	-0.15	1	1	0	4.16	1	1.05	0.95;
	24	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	26	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	27	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	29	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	31	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	32	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	35	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	40	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	34	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	36	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	17	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	21	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	22	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	23	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	62	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	64	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	65	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	67	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	69	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	70	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	71	1	0	0	0.075	-0.035	1	1	0	4.16	1	1.05	0.95;
	72	1	0	0	0.14	-0.1	1	1	0	4.16	1	1.05	0.95;
	73	1	0	0	0.075	-0.035	1	1	0	4.16	1	1.05	0.95;
	68	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	%132	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	76	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	82	1	0	0	0.245	-0.18	1	1	0	4.16	1	1.05	0.95;
	85	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	87	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	89	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	90	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	91	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	93	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	81	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	83	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	84	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	86	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	95	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	97	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	99	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	101	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	102	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	96	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	98	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	100	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	103	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	104	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	88	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	92	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	94	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	75	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	78	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	79	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	80	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	105	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	106	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	107	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	108	1	0	0	0	0	1	1	9	4.16	1	1.1	0.88;
	111	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
	113	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	114	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	115	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	117	1	0	0	0.04	-0.02	1	1	0	4.16	1	1.05	0.95;
	119	1	0	0	0	0	1	1	0	4.16	1	1.1	0.88;
	121	1	0	0	0.02	-0.01	1	1	0	4.16	1	1.05	0.95;
];
mpc.bus(:,5)=mpc.bus(:,5)*70/100;
mpc.bus(:,6)=mpc.bus(:,6)*70/100;
%% generator data
%	bus	Pg	Qg	Qmax	Qmin	Vg	mBase	status	Pmax	Pmin	Pc1	Pc2	Qc1min	Qc1max	Qc2min	Qc2max	ramp_agc	ramp_10	ramp_30	ramp_q	apf
mpc.gen = [
	1	1.2     0.5 100     -100    1.01	0	1	100	    -100	0	0	0	0	0	0	0	0	0	0	0;
 	6	0.2 	0	0.10	-0.10	1	0	1	0.25	0.15	0	0	0	0	0	0	0	0	0	0	0;
    %12	0.2 	0	0.10	-0.10	1	0	1	0.20	0.20	0	0	0	0	0	0	0	0	0	0	0;
 	%23	0.2 	0	0.10	-0.10	1	0	1	0.25	0.15	0	0	0	0	0	0	0	0	0	0	0;
    59	0.2     0	0.10	-0.10	1	0	1	0.25	0.15	0	0	0	0	0	0	0	0	0	0	0;
 	%79	0.2 	0	0.10	-0.10	1	0	1	0.25	0.15	0	0	0	0	0	0	0	0	0	0	0;
    %112	0.2     0	0.10	-0.10	1	0	1	0.20	0.20	0	0	0	0	0	0	0	0	0	0	0;
    %70	0.2     0	0.10	-0.10	1	0	1	0.20	0.20	0	0	0	0	0	0	0	0	0	0	0;
 	%85	0.2     0	0.10	-0.10	1	0	1	0.25	0.15	0	0	0	0	0	0	0	0	0	0	0;
 	%95	0.2     0	0.10	-0.10	1	0	1	0.20	0.20	0	0	0	0	0	0	0	0	0	0	0;
    122	0.2     0	0.10	-0.10	1	0	1	0.25	0.15	0	0	0	0	0	0	0	0	0	0	0;
    18	0.2     0	0.10	-0.10	1	0	1	0.25	0.15	0	0	0	0	0	0	0	0	0	0	0;
 	%38	0.2     0	0.10	-0.10	1	0	1	0.20	0.20	0	0	0	0	0	0	0	0	0	0	0;
    %43	0.2     0	0.10	-0.10	1	0	1	0.25	0.15	0	0	0	0	0	0	0	0	0	0   0;
 	%57	0.2     0	0.10	-0.10	1	0	1	0.20	0.20	0	0	0	0	0	0	0	0	0	0	0;
 	45	0.2     0	0.10	-0.10	1	0	1	0.20	0.20	0	0	0	0	0	0	0	0	0	0	0;
];

%% branch data
%	fbus	tbus	r	x	b	rateA	rateB	rateC	ratio	angle	status	angmin	angmax	Pf	Qf	Pt	Qt
mpc.branch = [
	1	3	0.002	0.016	0	0	0	0	1/1.0	0	1	-360	360	1.1957	0.4804	-1.1926	-0.4557;
	3	4	0.00133984767	0.00274492233	9.06e-06	0	0	0	0	0	1	-360	360	1.1926	0.4557	-1.1864	-0.4430;
	4	400	3.33333333e-07	3.33333333e-07	0	0	0	0	0	0	1	-360	360	1.1397	0.4197	-1.1397	-0.4197;
	400	7	0.00100488567	0.00205869167	6.81e-06	0	0	0	0	0	1	-360	360	1.1330	0.4163	-1.1288	-0.4077;
	7	11	0.000669924	0.001372461	4.53e-06	0	0	0	0	0	1	-360	360	1.1231	0.4038	-1.1203	-0.3981;
	11	1100	3.33333333e-07	3.33333333e-07	0	0	0	0	0	0	1	-360	360	1.0870	0.3814	-1.0870	-0.3814;
	1100	14	0.00100488567	0.00205869167	6.81e-06	0	0	0	0	0	1	-360	360	1.0803	0.3781	-1.0764	-0.3701;
	14	1400	3.33333333e-07	3.33333333e-07	0	0	0	0	0	0	1	-360	360	0.7022	0.1483	-0.7022	-0.1483;
	1400	126	1.66666667e-05	1.66666667e-05	0	0	0	0	0	0	1	-360	360	0.6688	0.1316	-0.6688	-0.1316;
	126	59	0.00133984767	0.00274492233	9.06e-06	0	0	0	0	0	1	-360	360	0.6688	0.1316	-0.6669	-0.1278;
	59	60	0.000669924	0.001372461	4.53e-06	0	0	0	0	0	1	-360	360	0.6536	0.1211	-0.6527	-0.1193;
	60	61	0.000418702333	0.000857788333	2.835e-06	0	0	0	0	0	1	-360	360	0.6394	0.1127	-0.6389	-0.1116;
	61	63	0.00117236667	0.002401807	7.92e-06	0	0	0	0	0	1	-360	360	0.6255	0.1049	-0.6241	-0.1020;
	63	66	0.00251221433	0.005146729	1.701e-05	0	0	0	0	0	1	-360	360	0.6108	0.0953	-0.6078	-0.0894;
	66	6600	3.33333333e-07	3.33333333e-07	0	0	0	0	0	0	1	-360	360	0.4773	0.0159	-0.4773	-0.0159;
	6600	128	1.66666667e-05	1.66666667e-05	0	0	0	0	0	0	1	-360	360	0.4773	0.0159	-0.4773	-0.0159;
	128	127	1.66666667e-05	1.66666667e-05	0	0	0	0	0	0	1	-360	360	0.4773	0.0159	-0.4773	-0.0159;
	127	74	0.00117236667	0.002401807	7.92e-06	0	0	0	1/1.0	0	1	-360	360	0.4773	0.0159	-0.4765	-0.0142;
	74	7400	3.33333333e-07	3.33333333e-07	0	0	0	0	0	0	1	-360	360	0.1870	0.0938	-0.1870	-0.0938;
	7400	77	0.000837404667	0.00171557633	5.67e-06	0	0	0	0	0	1	-360	360	0.1470	0.0737	-0.1469	-0.0736;
	77	109	1.66666667e-05	1.66666667e-05	0	0	0	0	0	0	1	-360	360	0.1069	0.0536	-0.1069	-0.0536;
	109	110	0.000837404667	0.00171557633	5.67e-06	0	0	0	0	0	1	-360	360	0.1069	0.0536	-0.1068	-0.0535;
	110	112	0.000921145333	0.001887134	6.24e-06	0	0	0	0	0	1	-360	360	0.0735	0.0368	-0.0735	-0.0368;
	112	116	0.00108862633	0.00223024933	7.38e-06	0	0	0	0	0	1	-360	360	0.0468	0.0234	-0.0468	-0.0234;
	116	118	0.00654609433	0.006636219	6.66e-06	0	0	0	0	0	1	-360	360	0.0468	0.0234	-0.0467	-0.0234;
	118	120	0.004364063	0.004424146	4.44e-06	0	0	0	0	0	1	-360	360	0.0334	0.0167	-0.0334	-0.0167;
	120	122	0.00181835967	0.001843394	1.851e-06	0	0	0	0	0	1	-360	360	0.0267	0.0133	-0.0267	-0.0133;
	122	123	0.00763711	0.00774225533	7.77e-06	0	0	0	0	0	1	-360	360	0.0200	0.0100	-0.0200	-0.0100;
	123	124	0.00472773467	0.00479282467	4.8e-06	0	0	0	0	0	1	-360	360	0.0067	0.0033	-0.0067	-0.0033;
	4	6	0.003636719	0.00368678833	3.69e-06	0	0	0	0	0	1	-360	360	0.0334	0.0167	-0.0333	-0.0167;
	6	9	0.00472773467	0.00479282467	4.8e-06	0	0	0	0	0	1	-360	360	0.0200	0.0100	-0.0200	-0.0100;
	9	10	0.003636719	0.00368678833	3.69e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	6	8	0.00290937533	0.00294943067	2.961e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	400	5	0.00254570333	0.00258075167	2.592e-06	0	0	0	0	0	1	-360	360	0.0067	0.0033	-0.0067	-0.0033;
	11	13	0.00327304733	0.00331810933	3.33e-06	0	0	0	0	0	1	-360	360	0.0334	0.0167	-0.0333	-0.0167;
	13	15	1.66666667e-05	1.66666667e-05	0	0	0	0	0	0	1	-360	360	0.0200	0.0100	-0.0200	-0.0100;
	15	16	0.00618242233	0.00626754	6.3e-06	0	0	0	0	0	1	-360	360	0.0200	0.0100	-0.0200	-0.0100;
	16	20	0.003636719	0.00368678833	3.69e-06	0	0	0	0	0	1	-360	360	0.0067	0.0033	-0.0067	-0.0033;
	16	19	0.003636719	0.00368678833	3.69e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	1100	12	0.00327304733	0.00331810933	3.33e-06	0	0	0	0	0	1	-360	360	0.0067	0.0033	-0.0067	-0.0033;
	14	18	0.002763436	0.005661402	1.869e-05	0	0	0	0	0	1	-360	360	0.3743	0.2218	-0.3727	-0.2187;
	18	1800	3.33333333e-07	3.33333333e-07	0	0	0	0	0	0	1	-360	360	0.1201	0.0602	-0.1201	-0.0602;
	1800	25	0.00100488567	0.00205869167	6.81e-06	0	0	0	0	0	1	-360	360	0.0934	0.0468	-0.0934	-0.0468;
	25	28	0.000837404667	0.00171557633	5.67e-06	0	0	0	0	0	1	-360	360	0.0801	0.0401	-0.0800	-0.0401;
	28	30	0.000921145333	0.001887134	6.24e-06	0	0	0	0	0	1	-360	360	0.0667	0.0334	-0.0667	-0.0334;
	30	33	0.000669924	0.001372461	4.53e-06	0	0	0	0	0	1	-360	360	0.0400	0.0200	-0.0400	-0.0200;
	33	37	0.00100488567	0.00205869167	6.81e-06	0	0	0	0	0	1	-360	360	0.0267	0.0133	-0.0267	-0.0133;
	37	38	0.00117236667	0.002401807	7.92e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	38	39	0.000669924	0.001372461	4.53e-06	0	0	0	0	0	1	-360	360	-0.0000	-0.0000	0.0000	0.0000;
	18	125	1.66666667e-05	1.66666667e-05	0	0	0	0	0	0	1	-360	360	0.2526	0.1585	-0.2526	-0.1585;
	125	41	0.00125610733	0.00257336467	7.56e-06	0	0	0	0	0	1	-360	360	0.2526	0.1585	-0.2522	-0.1578;
	41	43	0.000837404667	0.00171557633	5.67e-06	0	0	0	0	0	1	-360	360	0.2122	0.1378	-0.2121	-0.1375;
	43	48	0.000837404667	0.00171557633	5.67e-06	0	0	0	0	0	1	-360	360	0.2054	0.1341	-0.2052	-0.1338;
	48	50	0.000669924	0.001372461	4.53e-06	0	0	0	0	0	1	-360	360	0.1852	0.1238	-0.1851	-0.1236;
	50	52	0.000837404667	0.00171557633	5.67e-06	0	0	0	0	0	1	-360	360	0.1718	0.1169	-0.1717	-0.1167;
	52	55	0.000837404667	0.00171557633	5.04e-06	0	0	0	0	0	1	-360	360	0.0667	0.0417	-0.0667	-0.0417;
	55	56	0.000837404667	0.00171557633	5.04e-06	0	0	0	0	0	1	-360	360	0.0200	0.0100	-0.0200	-0.0100;
	56	57	0.000837404667	0.00171557633	5.04e-06	0	0	0	0	0	1	-360	360	0.0067	0.0033	-0.0067	-0.0033;
	57	58	0.00167480967	0.00343115267	1.005e-05	0	0	0	0	0	1	-360	360	0.0000	-0.0000	0.0000	0.0000;
	41	42	0.004354268	0.009769182	2.64e-05	0	0	0	0	0	1	-360	360	0.0267	0.0134	-0.0267	-0.0133;
	42	45	0.003636719	0.00368678833	3.69e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	45	46	0.00472773467	0.00479282467	4.8e-06	0	0	0	0	0	1	-360	360	0.0067	0.0033	-0.0067	-0.0033;
	42	44	0.004364063	0.004424146	4.44e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	43	47	0.00472773467	0.00479282467	4.8e-06	0	0	0	0	0	1	-360	360	0.0067	0.0033	-0.0067	-0.0033;
	48	49	0.00727343833	0.00737357667	7.41e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	50	51	0.00290937533	0.00294943067	2.961e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	51	53	0.004364063	0.004424146	4.44e-06	0	0	0	0	0	1	-360	360	0.0067	0.0033	-0.0067	-0.0033;
	52	54	0.000502443	0.00102934567	3.03e-06	0	0	0	0	0	1	-360	360	0.0700	0.0500	-0.0700	-0.0500;
	1800	24	0.003636719	0.00368678833	3.69e-06	0	0	0	0	0	1	-360	360	0.0267	0.0133	-0.0267	-0.0133;
	24	26	0.00472773467	0.00479282467	4.8e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	25	27	0.00763711	0.00774225533	7.77e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	28	29	0.008000782	0.00811093433	8.16e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	30	31	1.66666667e-05	1.66666667e-05	0	0	0	0	0	0	1	-360	360	0.0267	0.0133	-0.0267	-0.0133;
	31	32	0.00234460567	0.00526032867	1.422e-05	0	0	0	0	0	1	-360	360	0.0267	0.0133	-0.0267	-0.0133;
	32	35	0.00327304733	0.00331810933	3.33e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	35	40	0.004364063	0.004424146	4.44e-06	0	0	0	0	0	1	-360	360	0.0067	0.0033	-0.0067	-0.0033;
	32	34	0.00184219033	0.00413311533	1.116e-05	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	34	36	0.00727343833	0.00737357667	7.41e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	1400	17	0.00218203133	0.002212073	2.223e-06	0	0	0	0	0	1	-360	360	0.0333	0.0167	-0.0333	-0.0167;
	17	21	0.00145468767	0.00147471533	1.482e-06	0	0	0	0	0	1	-360	360	0.0200	0.0100	-0.0200	-0.0100;
	21	22	0.00545507867	0.00553018233	5.55e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	21	23	0.00509140667	0.00516150367	5.19e-06	0	0	0	0	0	1	-360	360	0.0067	0.0033	-0.0067	-0.0033;
	61	62	0.000921145333	0.001887134	6.24e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	62	64	0.000921145333	0.001887134	6.24e-06	0	0	0	0	0	1	-360	360	0.0067	0.0033	-0.0067	-0.0033;
	63	65	0.003636719	0.00368678833	3.69e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	65	67	0.003636719	0.00368678833	3.69e-06	0	0	0	0	0	1	-360	360	0.0067	0.0033	-0.0067	-0.0033;
	66	69	0.00277496367	0.00132213667	5.52e-05	0	0	0	0	0	1	-360	360	0.1239	0.0701	-0.1237	-0.0701;
	69	70	0.00194247467	0.000925495667	3.87e-05	0	0	0	0	0	1	-360	360	0.1104	0.0634	-0.1103	-0.0634;
	70	71	0.003884949	0.001850991	7.71e-05	0	0	0	0	0	1	-360	360	0.0969	0.0567	-0.0968	-0.0567;
	71	72	0.00471743833	0.002247632	9.36e-05	0	0	0	0	0	1	-360	360	0.0718	0.0450	-0.0717	-0.0450;
	72	73	0.00360745267	0.00171877767	7.17e-05	0	0	0	0	0	1	-360	360	0.0250	0.0116	-0.0250	-0.0117;
	6600	68	0.00184229067	0.003774268	1.248e-05	0	0	0	0	0	1	-360	360	0.0000	-0.0000	0.0000	0.0000;
	%68	132	0.0282222222	0.0604444443	0	0	0	0	0	0	1	-360	360	0.0000	0.0000	0.0000	0.0000;
	74	76	0.000921145333	0.001887134	6.24e-06	0	0	0	0	0	1	-360	360	0.2895	-0.0796	-0.2892	0.0801;
	76	82	0.000669924	0.001372461	4.53e-06	0	0	0	0	0	1	-360	360	0.2492	-0.1001	-0.2490	0.1004;
	82	85	0.00133984767	0.00274492233	9.06e-06	0	0	0	0	0	1	-360	360	0.0806	-0.1554	-0.0805	0.1557;
	85	87	0.000334962	0.000686230667	2.268e-06	0	0	0	0	0	1	-360	360	0.0671	-0.1623	-0.0671	0.1624;
	87	89	0.001591069	0.003259595	1.077e-05	0	0	0	0	0	1	-360	360	0.0538	-0.1691	-0.0536	0.1694;
	89	90	0.000586183333	0.00120090333	3.96e-06	0	0	0	0	0	1	-360	360	0.0403	-0.1761	-0.0402	0.1762;
	90	91	0.000837404667	0.00171557633	5.67e-06	0	0	0	0	0	1	-360	360	0.0202	-0.1862	-0.0201	0.1864;
	91	93	0.000837404667	0.00171557633	5.67e-06	0	0	0	0	0	1	-360	360	0.0068	-0.1930	-0.0067	0.1932;
	76	81	0.004000391	0.004055467	4.08e-06	0	0	0	0	0	1	-360	360	0.0400	0.0200	-0.0400	-0.0200;
	81	83	0.00509140667	0.00516150367	5.19e-06	0	0	0	0	0	1	-360	360	0.0267	0.0133	-0.0267	-0.0133;
	83	84	0.00581875067	0.00589886133	5.91e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	82	86	0.00234473367	0.00480361367	1.587e-05	0	0	0	0	0	1	-360	360	0.0868	-0.0050	-0.0867	0.0051;
	86	95	0.00150732867	0.00308803733	1.02e-05	0	0	0	0	0	1	-360	360	0.0801	-0.0084	-0.0800	0.0085;
	95	97	0.000921145333	0.001887134	6.24e-06	0	0	0	0	0	1	-360	360	0.0534	-0.0057	-0.0533	0.0057;
	97	99	0.000753664333	0.00154401867	5.1e-06	0	0	0	0	0	1	-360	360	0.0400	0.0038	-0.0400	-0.0038;
	99	101	0.000753664333	0.00154401867	5.1e-06	0	0	0	0	0	1	-360	360	0.0267	0.0133	-0.0267	-0.0133;
	101	102	0.004000391	0.004055467	4.08e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	95	96	0.00254570333	0.00258075167	2.592e-06	0	0	0	0	0	1	-360	360	0.0133	-0.0095	-0.0133	0.0095;
	97	98	0.003636719	0.00368678833	3.69e-06	0	0	0	0	0	1	-360	360	0.0133	-0.0095	-0.0133	0.0095;
	99	100	0.004364063	0.004424146	4.44e-06	0	0	0	0	0	1	-360	360	0.0133	-0.0095	-0.0133	0.0095;
	101	103	0.00100488567	0.00205869167	6.81e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	103	104	0.00290937533	0.00294943067	2.961e-06	0	0	0	0	0	1	-360	360	0.0067	0.0033	-0.0067	-0.0033;
	87	88	0.000753664333	0.00154401867	5.1e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	90	92	0.00981914167	0.00995432833	9.99e-06	0	0	0	0	0	1	-360	360	0.0200	0.0100	-0.0200	-0.0100;
	92	94	0.00690976633	0.00700489767	7.05e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	7400	75	0.00290937533	0.00294943067	2.961e-06	0	0	0	0	0	1	-360	360	0.0400	0.0200	-0.0400	-0.0200;
	75	78	0.004000391	0.004055467	4.08e-06	0	0	0	0	0	1	-360	360	0.0334	0.0167	-0.0333	-0.0167;
	78	79	0.00472773467	0.00479282467	4.8e-06	0	0	0	0	0	1	-360	360	0.0200	0.0100	-0.0200	-0.0100;
	79	80	0.004000391	0.004055467	4.08e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	77	105	0.000921145333	0.001887134	6.24e-06	0	0	0	0	0	1	-360	360	0.0400	0.0200	-0.0400	-0.0200;
	105	106	0.00184229067	0.003774268	1.248e-05	0	0	0	0	0	1	-360	360	0.0267	0.0133	-0.0267	-0.0133;
	106	107	0.00100488567	0.00205869167	6.81e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	107	108	0.00267969533	0.00548984433	1.812e-05	0	0	0	0	0	1	-360	360	0.0000	-0.0000	0.0000	0.0000;
	110	111	0.00327304733	0.00331810933	3.33e-06	0	0	0	0	0	1	-360	360	0.0334	0.0167	-0.0334	-0.0167;
	111	113	0.00472773467	0.00479282467	4.8e-06	0	0	0	0	0	1	-360	360	0.0267	0.0133	-0.0267	-0.0133;
	113	114	0.0101828133	0.0103230073	1.038e-05	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	112	115	0.00327304733	0.00331810933	3.33e-06	0	0	0	0	0	1	-360	360	0.0267	0.0133	-0.0267	-0.0133;
	115	117	0.008364454	0.008479613	8.52e-06	0	0	0	0	0	1	-360	360	0.0133	0.0067	-0.0133	-0.0067;
	116	119	0.00334961933	0.00686230533	2.268e-05	0	0	0	0	0	1	-360	360	0.0000	-0.0000	0.0000	0.0000;
	120	121	0.008364454	0.008479613	8.52e-06	0	0	0	0	0	1	-360	360	0.0067	0.0033	-0.0067	-0.0033;
];


mpc.gencost=[2 0 0 0;
    2 0 0 0;
    2 0 0 0;
    2 0 0 0;
    2 0 0 0;
    2 0 0 0;
    %2 0 0 0;
    %2 0 0 0;
    %2 0 0 0;
    %2 0 0 0;
    %2 0 0 0;
    %2 0 0 0;
    %2 0 0 0;
    %2 0 0 0;
    %2 0 0 0;
    %2 0 0 0
    ];

%%%%%OPF che ottimizza tutte le tensioni nodali%%%%%%%%%%%%%

% w=278;           %numero di tutte le variabili del problema(incluso lo slack): 133 teta, 133 amp, 5 Pder + Pslack e 5 Qder + Qslack
% nw=131;          %numero di tensioni da ottmizzare (tutte tranne slack e MV(4.16kV) busbar in cabina
% d=2*ones(nw,1); %2 è l'esponente della variabile della funzione di ottimizzazione
% r_cap=zeros(nw,1);    %0=shift delle tensioni che devono essre ottimizzate
% k=zeros(nw,1);        %0=dead zone
% m=ones(nw,1);         % 1=coefficiente moltipilcativo delle tensioni che devono essere ottimizzate
% mpc.fparm=[d r_cap k m];
% mpc.N=zeros(nw,w);  %la dimensione di z è nulla
% for i=1:nw
%     mpc.N(i,(nw+2)+i+2)=1;  %tensioni da ottimizzare
% end
% 
% mpc.N=sparse(mpc.N);
% mpc.H=sparse(2*eye(nw,nw));
% mpc.Cw=-2*ones(nw,1);
% mpc.A=zeros(1,w); 
% mpc.A(1,(nw+2)+1)=1.0; %tensione dello slack imposta(1.0 è un comando)
% mpc.A=sparse(mpc.A);
% mpc.l=1.0;
% mpc.u=mpc.l;    %tensione può variare tra mpc.u e mpc.l
 
%%%%%OPF che ottimizza le 4 tensioni dei nodi pilota%%%%%%%%%%%%%
% 
w=278;           %numero di tutte le variabili del problema(incluso lo slack): 133 teta, 133 amp, 15 Pder * Pslack e 15 Qder + Qslack
nw=4;          %numero di tensioni da ottmizzare (tutte tranne slack e MV(4.16kV) busbar in cabina
d=[2; 2; 2; 2];         %2=esponente 5 tensioni da ottimizzare (tolto lo slack, se presente nelle 5VCA)
r_cap=[0; 0; 0; 0];     %0=shift delle 5 tensioni da ottimizzare
k=[0; 0; 0; 0];         %0=dead zone
m=[1; 1; 1; 1];         %1=coefficiente delle 5 tensioni da ottimizzare (tolto lo slack, se presente nelle %VCA)
mpc.fparm=[d r_cap k m]; 
mpc.N=zeros(4,278);    %variabili nw=4, variabili w=62 (24 teta, 24 V, 7 Pg, 7 Qg (incluso lo slack))
mpc.N(1,133+6)=1;     %1 tensione, nodo numero 10 (posizione 34=24+10 nel vettore w)
mpc.N(2,133+19)=1;      %2 tensione, nodo numero 7  (posizione 31=24+7 nel vettore w)
mpc.N(3,133+27)=1;     %3 tensione, nodo numero 20 (posizione 44=24+20 nel vettore w) 
mpc.N(4,133+42)=1;     %4 tensione, nodo numero 18 (posizione 41=24+18 nel vettore w) 
% mpc.N(1,24+5)=1;     %1 tensione, nodo numero 10 (posizione 34=24+10 nel vettore w)
% mpc.N(2,24+20)=1;      %2 tensione, nodo numero 7  (posizione 31=24+7 nel vettore w)
% mpc.N(3,24+18)=1;     %3 tensione, nodo numero 20 (posizione 44=24+20 nel vettore w) 
% mpc.N(4,24+23)=1;     %5 tensione, nodo numero 23  (posizione 47=24+23 nel vettore w) 

mpc.N=sparse(mpc.N);
mpc.H=sparse(2*eye(4,4));
mpc.Cw=[-2; -2; -2; -2]; 
mpc.A=zeros(1,278);
mpc.A(1,133+1)=1.0;   %       tensione dello slack imposta 
mpc.A=sparse(mpc.A);
mpc.l=1;            % 0.99 p.u. è l'ampiezza della tensione nel nodo slack
mpc.u=mpc.l;

%%%%%OPF che ottimizza le 5 tensioni dei nodi pilota%%%%%%%%%%%%%
% d=[2; 2; 2; 2; 2];         %2=esponente 5 tensioni da ottimizzare (tolto lo slack, se presente nelle 5VCA)
% r_cap=[0; 0; 0; 0; 0];     %0=shift delle 5 tensioni da ottimizzare
% k=[0; 0; 0; 0; 0];         %0=dead zone
% m=[1; 1; 1; 1; 1];         %1=coefficiente delle 5 tensioni da ottimizzare (tolto lo slack, se presente nelle %VCA)
% mpc.fparm=[d r_cap k m]; 
% mpc.N=zeros(5,62);    %variabili nw=5, variabili w=62 (24 teta, 24 V, 7 Pg, 7 Qg (incluso lo slack))
% mpc.N(1,24+5)=1;     %1 tensione, nodo numero 10 (posizione 34=24+10 nel vettore w)
% mpc.N(2,24+15)=1;      %2 tensione, nodo numero 7  (posizione 31=24+7 nel vettore w)
% mpc.N(3,24+18)=1;     %3 tensione, nodo numero 20 (posizione 44=24+20 nel vettore w) 
% mpc.N(4,24+21)=1;     %4 tensione, nodo numero 18 (posizione 41=24+18 nel vettore w) 
% mpc.N(5,24+23)=1;     %5 tensione, nodo numero 23  (posizione 47=24+23 nel vettore w) 
% % mpc.N(1,24+10)=1;     %1 tensione, nodo numero 10 (posizione 34=24+10 nel vettore w)
% % mpc.N(2,24+7)=1;      %2 tensione, nodo numero 7  (posizione 31=24+7 nel vettore w)
% % mpc.N(3,24+18)=1;     %3 tensione, nodo numero 20 (posizione 44=24+20 nel vettore w) 
% % mpc.N(4,24+20)=1;     %4 tensione, nodo numero 18 (posizione 41=24+18 nel vettore w) 
% % mpc.N(5,24+23)=1;     %5 tensione, nodo numero 23  (posizione 47=24+23 nel vettore w) 
% 
% mpc.N=sparse(mpc.N);
% mpc.H=sparse(2*eye(5,5));
% mpc.Cw=[-2; -2; -2; -2; -2]; 
% mpc.A=zeros(1,62);
% mpc.A(1,24+1)=1.0;   %       tensione dello slack imposta 
% mpc.A=sparse(mpc.A);
% mpc.l=1;            % 0.975 p.u. è l'ampiezza della tensione nel nodo slack
% mpc.u=mpc.l;

%%%%%OPF che ottimizza le 6 tensioni dei nodi pilota%%%%%%%%%%%%%
% 


% d=[2; 2; 2; 2; 2; 2];         %2=esponente 5 tensioni da ottimizzare (tolto lo slack, se presente nelle 5VCA)
% r_cap=[0; 0; 0; 0; 0; 0];     %0=shift delle 5 tensioni da ottimizzare
% k=[0; 0; 0; 0; 0; 0];         %0=dead zone
% m=[1; 1; 1; 1; 1; 1];         %1=coefficiente delle 5 tensioni da ottimizzare (tolto lo slack, se presente nelle %VCA)
% mpc.fparm=[d r_cap k m];  
% mpc.N=zeros(6,62);    %variabili nw=5, variabili w=62 (24 teta, 24 V, 7 Pg, 7 Qg (incluso lo slack))
% mpc.N(1,24+10)=1;     %1 tensione, nodo numero 10 (posizione 34=24+10 nel vettore w)
% mpc.N(2,24+7)=1;      %2 tensione, nodo numero 7  (posizione 31=24+7 nel vettore w)
% mpc.N(3,24+15)=1;     %3 tensione, nodo numero 20 (posizione 44=24+20 nel vettore w) 
% mpc.N(4,24+18)=1;     %4 tensione, nodo numero 18 (posizione 41=24+18 nel vettore w)
% mpc.N(5,24+21)=1;     %5 tensione, nodo numero 23  (posizione 47=24+23 nel vettore w)
% mpc.N(6,24+23)=1;     %5 tensione, nodo numero 23  (posizione 47=24+23 nel vettore w) 
% 
% mpc.N=sparse(mpc.N);
% mpc.H=sparse(2*eye(6,6));
% mpc.Cw=[-2; -2; -2; -2; -2; -2]; 
% mpc.A=zeros(1,62);
% mpc.A(1,24+1)=1.0;   %       tensione dello slack imposta 
% mpc.A=sparse(mpc.A);
% mpc.l=1;            % 0.975 p.u. è l'ampiezza della tensione nel nodo slack
% mpc.u=mpc.l;
